// /api/prisma/schema.prisma

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("POSTGRES_PRISMA_URL") // Vercel provides this variable
}

model User {
  id            String    @id @default(cuid())
  username      String    @unique
  email         String    @unique
  passwordHash  String
  conversations Conversation[]
  sentMessages  Message[]
}

model Conversation {
  id        String    @id @default(cuid())
  users     User[]    @relation(fields: [userIds], references: [id])
  userIds   String[]
  messages  Message[]
  createdAt DateTime @default(now())
}

model Message {
  id              String        @id @default(cuid())
  sender          User          @relation(fields: [senderId], references: [id])
  senderId        String
  content         String
  createdAt       DateTime      @default(now())
  conversation    Conversation  @relation(fields: [conversationId], references: [id])
  conversationId  String
}
